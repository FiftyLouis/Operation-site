G
IC:\Users\lbo\source\repos\LogosAPI\LogosAPI\Controllers\AuthController.cs
	namespace

 	
LogosAPI


 
.

 
Controllers

 
{ 
[ 
Route 

(
 
$str &
)& '
]' (
[ 
ApiController 
] 
public 

class 
AuthController 
:  !
ControllerBase" 0
{ 
private 
readonly 
IConfiguration '
configuration( 5
;5 6
private 
readonly 

ApiContext #
_context$ ,
;, -
public 
AuthController 
( 
IConfiguration ,
configuration- :
,: ;

ApiContext< F
contextG N
)N O
{ 	
this 
. 
configuration 
=  
configuration! .
;. /
this 
. 
_context 
= 
context #
;# $
} 	
[ 	
HttpPost	 
( 
$str 
) 
] 
public 
async 
Task 
< 
ActionResult &
<& '
User' +
>+ ,
>, -
Register. 6
(6 7
UserDto7 >
request? F
)F G
{ 	
CreatePasswordHash 
( 
request &
.& '
Password' /
,/ 0
out1 4
byte5 9
[9 :
]: ;
passwordHash< H
,H I
outJ M
byteN R
[R S
]S T
passwordSaltU a
)a b
;b c
User 
user 
= 
new 
User  
(  !
)! "
;" #
foreach 
( 
var 
u 
in 
_context %
.% &
Users& +
)+ ,
{   
if!! 
(!! 
u!! 
.!! 
UserName!! 
.!! 
Equals!! %
(!!% &
request!!& -
.!!- .
UserName!!. 6
)!!6 7
)!!7 8
{!!9 :
return"" 

BadRequest"" %
(""% &
$str""& C
)""C D
;""D E
}## 
}$$ 
user%% 
.%% 
UserName%% 
=%% 
request%% #
.%%# $
UserName%%$ ,
;%%, -
user&& 
.&& 
PasswordSalt&& 
=&& 
passwordSalt&&  ,
;&&, -
user'' 
.'' 
PasswordHash'' 
='' 
passwordHash''  ,
;'', -
_context(( 
.(( 
Add(( 
((( 
user(( 
)(( 
;(( 
_context** 
.** 
SaveChanges**  
(**  !
)**! "
;**" #
return-- 
Ok-- 
(-- 
user-- 
)-- 
;-- 
}.. 	
[00 	
HttpPost00	 
(00 
$str00 
)00 
]00 
public11 
async11 
Task11 
<11 
ActionResult11 &
<11& '
User11' +
>11+ ,
>11, -
Login11. 3
(113 4
UserDto114 ;
request11< C
)11C D
{22 	
foreach44 
(44 
var44 
user44 
in44 
_context44  (
.44( )
Users44) .
)44. /
{55 
if66 
(66 
user66 
.66 
UserName66 !
.66! "
Equals66" (
(66( )
request66) 0
.660 1
UserName661 9
)669 :
)66: ;
{77 
if88 
(88 
VerifyPasswordHash88 *
(88* +
request88+ 2
.882 3
Password883 ;
,88; <
user88= A
.88A B
PasswordHash88B N
,88N O
user88P T
.88T U
PasswordSalt88U a
)88a b
)88b c
{99 
string:: 
token:: $
=::% &
CreateToken::' 2
(::2 3
user::3 7
)::7 8
;::8 9
return;; 
Ok;; !
(;;! "
token;;" '
);;' (
;;;( )
}<< 
return== 

BadRequest== %
(==% &
$str==& 4
)==4 5
;==5 6
}>> 
}?? 
return@@ 

BadRequest@@ 
(@@ 
$str@@ /
)@@/ 0
;@@0 1
}AA 	
privateCC 
stringCC 
CreateTokenCC "
(CC" #
UserCC# '
userCC( ,
)CC, -
{DD 	
ListEE 
<EE 
ClaimEE 
>EE 
claimsEE 
=EE  
newEE! $
ListEE% )
<EE) *
ClaimEE* /
>EE/ 0
{FF 
newGG 
ClaimGG 
(GG 

ClaimTypesGG $
.GG$ %
NameGG% )
,GG) *
userGG+ /
.GG/ 0
UserNameGG0 8
)GG8 9
}HH 
;HH 
varJJ 
keyJJ 
=JJ 
newJJ  
SymmetricSecurityKeyJJ .
(JJ. /
SystemJJ/ 5
.JJ5 6
TextJJ6 :
.JJ: ;
EncodingJJ; C
.JJC D
UTF8JJD H
.JJH I
GetBytesJJI Q
(JJQ R
configurationJJR _
.JJ_ `

GetSectionJJ` j
(JJj k
$strJJk ~
)JJ~ 
.	JJ €
Value
JJ€ …
)
JJ… †
)
JJ† ‡
;
JJ‡ 
varLL 
credsLL 
=LL 
newLL 
SigningCredentialsLL .
(LL. /
keyLL/ 2
,LL2 3
SecurityAlgorithmsLL4 F
.LLF G
HmacSha512SignatureLLG Z
)LLZ [
;LL[ \
varNN 
tokenNN 
=NN 
newNN 
JwtSecurityTokenNN ,
(NN, -
claimsOO 
:OO 
claimsOO 
,OO 
expiresPP 
:PP 
DateTimePP !
.PP! "
NowPP" %
.PP% &
AddDaysPP& -
(PP- .
$numPP. /
)PP/ 0
,PP0 1
signingCredentialsQQ "
:QQ" #
credsQQ$ )
)RR 
;RR 
varTT 
jwtTT 
=TT 
newTT #
JwtSecurityTokenHandlerTT 1
(TT1 2
)TT2 3
.TT3 4

WriteTokenTT4 >
(TT> ?
tokenTT? D
)TTD E
;TTE F
returnWW 
jwtWW 
;WW 
}XX 	
privateZZ 
voidZZ 
CreatePasswordHashZZ '
(ZZ' (
stringZZ( .
passwordZZ/ 7
,ZZ7 8
outZZ9 <
byteZZ= A
[ZZA B
]ZZB C
passwordHashZZD P
,ZZP Q
outZZR U
byteZZV Z
[ZZZ [
]ZZ[ \
passwordSaltZZ] i
)ZZi j
{[[ 	
using\\ 
(\\ 
var\\ 
hmac\\ 
=\\ 
new\\ !

HMACSHA512\\" ,
(\\, -
)\\- .
)\\. /
{]] 
passwordSalt^^ 
=^^ 
hmac^^ #
.^^# $
Key^^$ '
;^^' (
passwordHash__ 
=__ 
hmac__ #
.__# $
ComputeHash__$ /
(__/ 0
System__0 6
.__6 7
Text__7 ;
.__; <
Encoding__< D
.__D E
UTF8__E I
.__I J
GetBytes__J R
(__R S
password__S [
)__[ \
)__\ ]
;__] ^
}`` 
}aa 	
privatecc 
boolcc 
VerifyPasswordHashcc '
(cc' (
stringcc( .
passwordcc/ 7
,cc7 8
bytecc9 =
[cc= >
]cc> ?
passwordHashcc@ L
,ccL M
byteccN R
[ccR S
]ccS T
passwordSaltccU a
)cca b
{dd 	
usingee 
(ee 
varee 
hmacee 
=ee 
newee  

HMACSHA512ee! +
(ee+ ,
passwordSaltee, 8
)ee8 9
)ee9 :
{ff 
vargg 
computedhashgg !
=gg" #
hmacgg$ (
.gg( )
ComputeHashgg) 4
(gg4 5
Systemgg5 ;
.gg; <
Textgg< @
.gg@ A
EncodingggA I
.ggI J
UTF8ggJ N
.ggN O
GetBytesggO W
(ggW X
passwordggX `
)gg` a
)gga b
;ggb c
returnhh 
computedhashhh #
.hh# $
SequenceEqualhh$ 1
(hh1 2
passwordHashhh2 >
)hh> ?
;hh? @
}ii 
}jj 	
}kk 
}ll βο
JC:\Users\lbo\source\repos\LogosAPI\LogosAPI\Controllers\LogosController.cs
	namespace 	
LogosAPI
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str &
)& '
]' (
[		 
ApiController		 
]		 
[

 
	Authorize

 
]

 
public 

class 
LogosController  
:! "
ControllerBase# 1
{ 
private 
readonly 

ApiContext #
_context$ ,
;, -
public 
LogosController 
( 

ApiContext )
context* 1
)1 2
{ 	
_context 
= 
context 
; 
} 	
[ 	
HttpPost	 
, 
AllowAnonymous !
]! "
public 

JsonResult 
CreateEditIssues *
(* +
Issues+ 1
issues2 8
)8 9
{ 	
if 
( 
issues 
. 
id 
== 
$num 
) 
{ 
_context 
. 
Issues 
.  
Add  #
(# $
issues$ *
)* +
;+ ,
} 
else 
{ 
var 

issuesInDb 
=  
_context! )
.) *
Issues* 0
.0 1
Find1 5
(5 6
issues6 <
.< =
id= ?
)? @
;@ A
if 
( 

issuesInDb 
== !
null" &
)& '
return 
new 

JsonResult )
() *
NotFound* 2
(2 3
)3 4
)4 5
;5 6

issuesInDb   
=   
issues   #
;  # $
}!! 
_context## 
.## 
SaveChanges##  
(##  !
)##! "
;##" #
return%% 
new%% 

JsonResult%% !
(%%! "
Ok%%" $
(%%$ %
issues%%% +
)%%+ ,
)%%, -
;%%- .
}&& 	
[)) 	
HttpGet))	 
])) 
public** 

JsonResult** 
	GetIssues** #
(**# $
int**$ '
id**( *
)*** +
{++ 	
var,, 
issues,, 
=,, 
_context,, !
.,,! "
Issues,," (
.,,( )
Find,,) -
(,,- .
id,,. 0
),,0 1
;,,1 2
if.. 
(.. 
issues.. 
==.. 
null.. 
).. 
return// 
new// 

JsonResult// %
(//% &
NotFound//& .
(//. /
)/// 0
)//0 1
;//1 2
return11 
new11 

JsonResult11 !
(11! "
Ok11" $
(11$ %
issues11% +
)11+ ,
)11, -
;11- .
}22 	
[66 	

HttpDelete66	 
]66 
public77 

JsonResult77 
DeleteIssues77 &
(77& '
int77' *
id77+ -
)77- .
{88 	
var99 
issue99 
=99 
_context99  
.99  !
Issues99! '
.99' (
Find99( ,
(99, -
id99- /
)99/ 0
;990 1
if;; 
(;; 
issue;; 
==;; 
null;; 
);; 
return<< 
new<< 

JsonResult<< %
(<<% &
NotFound<<& .
(<<. /
)<</ 0
)<<0 1
;<<1 2
_context>> 
.>> 
Issues>> 
.>> 
Remove>> "
(>>" #
issue>># (
)>>( )
;>>) *
_context@@ 
.@@ 
SaveChanges@@  
(@@  !
)@@! "
;@@" #
returnBB 
newBB 

JsonResultBB !
(BB! "
OkBB" $
(BB$ %
issueBB% *
)BB* +
)BB+ ,
;BB, -
}CC 	
[FF 	
HttpGetFF	 
(FF 
$strFF  
)FF  !
]FF! "
publicGG 

JsonResultGG 
GetAllIssuesGG &
(GG& '
)GG' (
{HH 	
varII 
issuesII 
=II 
_contextII !
.II! "
IssuesII" (
.II( )
ToListII) /
(II/ 0
)II0 1
;II1 2
returnKK 
newKK 

JsonResultKK !
(KK! "
issuesKK" (
)KK( )
;KK) *
}LL 	
[OO 	
HttpPostOO	 
,OO 
AllowAnonymousOO !
]OO! "
publicPP 

JsonResultPP !
CreateEditMaintenancePP /
(PP/ 0
PlannedMaintenancePP0 B
pmPPC E
)PPE F
{QQ 	
ifRR 
(RR 
pmRR 
.RR 
idRR 
==RR 
$numRR 
)RR 
{SS 
_contextTT 
.TT 
PlannedMaintenanceTT +
.TT+ ,
AddTT, /
(TT/ 0
pmTT0 2
)TT2 3
;TT3 4
}UU 
elseVV 
{WW 
varXX 
pmInDbXX 
=XX 
_contextXX %
.XX% &
PlannedMaintenanceXX& 8
.XX8 9
FindXX9 =
(XX= >
pmXX> @
.XX@ A
idXXA C
)XXC D
;XXD E
ifYY 
(YY 
pmInDbYY 
==YY 
nullYY "
)YY" #
returnZZ 
newZZ 

JsonResultZZ )
(ZZ) *
NotFoundZZ* 2
(ZZ2 3
)ZZ3 4
)ZZ4 5
;ZZ5 6
pmInDb[[ 
=[[ 
pm[[ 
;[[ 
}\\ 
_context^^ 
.^^ 
SaveChanges^^  
(^^  !
)^^! "
;^^" #
return`` 
new`` 

JsonResult`` !
(``! "
Ok``" $
(``$ %
pm``% '
)``' (
)``( )
;``) *
}aa 	
[cc 	
HttpGetcc	 
]cc 
publicdd 

JsonResultdd 
GetPmdd 
(dd  
intdd  #
iddd$ &
)dd& '
{ee 	
varff 
pmff 
=ff 
_contextff 
.ff 
PlannedMaintenanceff /
.ff/ 0
Findff0 4
(ff4 5
idff5 7
)ff7 8
;ff8 9
ifhh 
(hh 
pmhh 
==hh 
nullhh 
)hh 
{ii 
returnjj 
newjj 

JsonResultjj %
(jj% &
NotFoundjj& .
(jj. /
)jj/ 0
)jj0 1
;jj1 2
}kk 
returnmm 
newmm 

JsonResultmm !
(mm! "
Okmm" $
(mm$ %
pmmm% '
)mm' (
)mm( )
;mm) *
}nn 	
[pp 	

HttpDeletepp	 
]pp 
publicqq 

JsonResultqq 
DeletePmqq "
(qq" #
intqq# &
idqq' )
)qq) *
{rr 	
varss 
pmss 
=ss 
_contextss 
.ss 
PlannedMaintenancess 0
.ss0 1
Findss1 5
(ss5 6
idss6 8
)ss8 9
;ss9 :
ifuu 
(uu 
pmuu 
==uu 
nulluu 
)uu 
{vv 
returnww 
newww 

JsonResultww %
(ww% &
NotFoundww& .
(ww. /
)ww/ 0
)ww0 1
;ww1 2
}xx 
_contextzz 
.zz 
PlannedMaintenancezz '
.zz' (
Removezz( .
(zz. /
pmzz/ 1
)zz1 2
;zz2 3
_context|| 
.|| 
SaveChanges||  
(||  !
)||! "
;||" #
return~~ 
new~~ 

JsonResult~~ !
(~~! "
Ok~~" $
(~~$ %
pm~~% '
)~~' (
)~~( )
;~~) *
} 	
[
 	
HttpGet
	 
(
 
$str
 
)
 
]
 
public
‚‚ 

JsonResult
‚‚ 
GetAllPm
‚‚ "
(
‚‚" #
)
‚‚# $
{
ƒƒ 	
var
„„ 
pms
„„ 
=
„„ 
_context
„„ 
.
„„  
PlannedMaintenance
„„ 1
.
„„1 2
ToList
„„2 8
(
„„8 9
)
„„9 :
;
„„: ;
return
†† 
new
†† 

JsonResult
†† !
(
††! "
pms
††" %
)
††% &
;
††& '
}
‡‡ 	
[
 	
HttpGet
	 
(
 
$str
 &
)
& '
,
' (
AllowAnonymous
) 7
]
7 8
public
 

JsonResult
  
GetPmScheduledDate
 ,
(
, -
)
- .
{
 	
List
 
<
  
PlannedMaintenance
 #
>
# $
pms
% (
=
) *
new
+ .
List
/ 3
<
3 4 
PlannedMaintenance
4 F
>
F G
(
G H
)
H I
;
I J
foreach
‘‘ 
(
‘‘ 
var
‘‘ 
pm
‘‘ 
in
‘‘ 
_context
‘‘ '
.
‘‘' ( 
PlannedMaintenance
‘‘( :
)
‘‘: ;
{
’’ 
int
““ 
Results
““ 
=
““ 
DateTime
““ %
.
““% &
Compare
““& -
(
““- .
pm
““. 0
.
““0 1
	scheduled
““1 :
,
““: ;
DateTime
““< D
.
““D E
Now
““E H
)
““H I
;
““I J
if
•• 
(
•• 
Results
•• 
>
•• 
$num
•• 
)
•• 
pms
–– 
.
–– 
Add
–– 
(
–– 
pm
–– 
)
–– 
;
––  
}
—— 
var
™™ 
	orderByPm
™™ 
=
™™ 
from
™™  
pm
™™! #
in
™™$ &
pms
™™' *
orderby
 #
pm
$ &
.
& '
dateofCreation
' 5
select
›› "
pm
››# %
;
››% &
pms
 
=
 
	orderByPm
 
.
 
ToList
 "
(
" #
)
# $
;
$ %
return
 
new
 

JsonResult
 !
(
! "
pms
" %
)
% &
;
& '
}
   	
[
¤¤ 	
HttpGet
¤¤	 
(
¤¤ 
$str
¤¤ $
)
¤¤$ %
,
¤¤% &
AllowAnonymous
¤¤' 5
]
¤¤5 6
public
¥¥ 

JsonResult
¥¥ 
GetCurrentIssues
¥¥ *
(
¥¥* +
)
¥¥+ ,
{
¦¦ 	
List
§§ 
<
§§ 
Issues
§§ 
>
§§ 
issues
§§ 
=
§§  !
new
§§" %
List
§§& *
<
§§* +
Issues
§§+ 1
>
§§1 2
(
§§2 3
)
§§3 4
;
§§4 5
foreach
©© 
(
©© 
var
©© 
issue
©© 
in
©© !
_context
©©" *
.
©©* +
Issues
©©+ 1
)
©©1 2
{
 
if
«« 
(
«« 
issue
«« 
.
«« 
Closing
««  
==
««! #
null
««$ (
)
««( )
issues
¬¬ 
.
¬¬ 
Add
¬¬ 
(
¬¬ 
issue
¬¬ $
)
¬¬$ %
;
¬¬% &
}
®® 
var
°° !
orderByTimeCreation
°° #
=
°°$ %
from
°°& *
issue
°°+ 0
in
°°1 3
issues
°°4 :
orderby
±±& -
issue
±±. 3
.
±±3 4
Date
±±4 8

descending
±±9 C
select
²²& ,
issue
²²- 2
;
²²2 3
issues
¶¶ 
=
¶¶ !
orderByTimeCreation
¶¶ (
.
¶¶( )
ToList
¶¶) /
(
¶¶/ 0
)
¶¶0 1
;
¶¶1 2
return
ΈΈ 
new
ΈΈ 

JsonResult
ΈΈ !
(
ΈΈ! "
issues
ΈΈ" (
)
ΈΈ( )
;
ΈΈ) *
}
ΉΉ 	
[
ΌΌ 	
HttpGet
ΌΌ	 
(
ΌΌ 
$str
ΌΌ '
)
ΌΌ' (
,
ΌΌ( )
AllowAnonymous
ΌΌ* 8
]
ΌΌ8 9
public
½½ 

JsonResult
½½ !
GetHistoricalIssues
½½ -
(
½½- .
)
½½. /
{
ΎΎ 	
List
ΏΏ 
<
ΏΏ 
Issues
ΏΏ 
>
ΏΏ 
issues
ΏΏ 
=
ΏΏ  !
new
ΏΏ" %
List
ΏΏ& *
<
ΏΏ* +
Issues
ΏΏ+ 1
>
ΏΏ1 2
(
ΏΏ2 3
)
ΏΏ3 4
;
ΏΏ4 5
foreach
ΑΑ 
(
ΑΑ 
var
ΑΑ 
issue
ΑΑ 
in
ΑΑ !
_context
ΑΑ" *
.
ΑΑ* +
Issues
ΑΑ+ 1
)
ΑΑ1 2
{
ΒΒ 
if
ΓΓ 
(
ΓΓ 
issue
ΓΓ 
.
ΓΓ 
Closing
ΓΓ !
!=
ΓΓ" $
null
ΓΓ% )
)
ΓΓ) *
issues
ΔΔ 
.
ΔΔ 
Add
ΔΔ 
(
ΔΔ 
issue
ΔΔ $
)
ΔΔ$ %
;
ΔΔ% &
}
ΖΖ 
var
ΘΘ !
orderByTimeCreation
ΘΘ #
=
ΘΘ$ %
from
ΘΘ& *
issue
ΘΘ+ 0
in
ΘΘ1 3
issues
ΘΘ4 :
orderby
ΙΙ& -
issue
ΙΙ. 3
.
ΙΙ3 4
Date
ΙΙ4 8

descending
ΙΙ9 C
select
ΚΚ& ,
issue
ΚΚ- 2
;
ΚΚ2 3
issues
ΝΝ 
=
ΝΝ !
orderByTimeCreation
ΝΝ (
.
ΝΝ( )
ToList
ΝΝ) /
(
ΝΝ/ 0
)
ΝΝ0 1
;
ΝΝ1 2
return
ΟΟ 
new
ΟΟ 

JsonResult
ΟΟ !
(
ΟΟ! "
issues
ΟΟ" (
)
ΟΟ( )
;
ΟΟ) *
}
ΠΠ 	
[
ΥΥ 	
HttpGet
ΥΥ	 
(
ΥΥ 
$str
ΥΥ )
)
ΥΥ) *
]
ΥΥ* +
public
ΦΦ 

JsonResult
ΦΦ #
GetCurrentIssuesAdmin
ΦΦ /
(
ΦΦ/ 0
)
ΦΦ0 1
{
ΧΧ 	
List
ΨΨ 
<
ΨΨ 
Issues
ΨΨ 
>
ΨΨ 
issues
ΨΨ 
=
ΨΨ  !
new
ΨΨ" %
List
ΨΨ& *
<
ΨΨ* +
Issues
ΨΨ+ 1
>
ΨΨ1 2
(
ΨΨ2 3
)
ΨΨ3 4
;
ΨΨ4 5
foreach
ΪΪ 
(
ΪΪ 
var
ΪΪ 
issue
ΪΪ 
in
ΪΪ !
_context
ΪΪ" *
.
ΪΪ* +
Issues
ΪΪ+ 1
)
ΪΪ1 2
{
ΫΫ 
if
άά 
(
άά 
issue
άά 
.
άά 
Closing
άά !
==
άά" $
null
άά% )
)
άά) *
issues
έέ 
.
έέ 
Add
έέ 
(
έέ 
issue
έέ $
)
έέ$ %
;
έέ% &
}
ίί 
var
αα !
orderByTimeCreation
αα #
=
αα$ %
from
αα& *
issue
αα+ 0
in
αα1 3
issues
αα4 :
orderby
ββ& -
issue
ββ. 3
.
ββ3 4
Date
ββ4 8

descending
ββ9 C
select
γγ& ,
issue
γγ- 2
;
γγ2 3
issues
ηη 
=
ηη !
orderByTimeCreation
ηη (
.
ηη( )
ToList
ηη) /
(
ηη/ 0
)
ηη0 1
;
ηη1 2
return
ιι 
new
ιι 

JsonResult
ιι !
(
ιι! "
issues
ιι" (
)
ιι( )
;
ιι) *
}
κκ 	
[
λλ 	
HttpPost
λλ	 
(
λλ 
$str
λλ  
)
λλ  !
]
λλ! "
public
μμ 

JsonResult
μμ 
SolvedIssue
μμ %
(
μμ% &
int
μμ& )
id
μμ* ,
,
μμ, -
DateTime
μμ. 6
date
μμ7 ;
)
μμ; <
{
νν 	
var
ξξ 
issue
ξξ 
=
ξξ 
_context
ξξ  
.
ξξ  !
Issues
ξξ! '
.
ξξ' (
Find
ξξ( ,
(
ξξ, -
id
ξξ- /
)
ξξ/ 0
;
ξξ0 1
if
ππ 
(
ππ 
issue
ππ 
==
ππ 
null
ππ 
)
ππ 
{
ρρ 
return
ςς 
new
ςς 

JsonResult
ςς %
(
ςς% &
NotFound
ςς& .
(
ςς. /
)
ςς/ 0
)
ςς0 1
;
ςς1 2
}
σσ 
_context
υυ 
.
υυ 
Issues
υυ 
.
υυ 
Find
υυ  
(
υυ  !
id
υυ! #
)
υυ# $
.
υυ$ %
Closing
υυ% ,
=
υυ- .
DateTime
υυ/ 7
.
υυ7 8
Now
υυ8 ;
;
υυ; <
_context
φφ 
.
φφ 
Issues
φφ 
.
φφ 
Find
φφ  
(
φφ  !
id
φφ! #
)
φφ# $
.
φφ$ %
Solving
φφ% ,
=
φφ- .
date
φφ/ 3
;
φφ3 4
_context
ωω 
.
ωω 
SaveChanges
ωω  
(
ωω  !
)
ωω! "
;
ωω" #
return
ϋϋ 
new
ϋϋ 

JsonResult
ϋϋ !
(
ϋϋ! "
issue
ϋϋ" '
)
ϋϋ' (
;
ϋϋ( )
}
ύύ 	
[
 
HttpPost
 
(
 
$str
 
)
 
]
  
public
€€ 

JsonResult
€€ 
CreateIssue
€€ %
(
€€% &
string
€€& ,
AffectedSolutions
€€- >
,
€€> ?
string
€€@ F
Text
€€G K
,
€€K L
DateTime
€€M U
ETA
€€V Y
)
€€Y Z
{
 	
Issues
‚‚ 
issue
‚‚ 
=
‚‚ 
new
‚‚ 
Issues
‚‚ %
(
‚‚% &
AffectedSolutions
‚‚& 7
,
‚‚7 8
Text
‚‚9 =
,
‚‚= >
ETA
‚‚? B
)
‚‚B C
;
‚‚C D
CreateEditIssues
ƒƒ 
(
ƒƒ 
issue
ƒƒ "
)
ƒƒ" #
;
ƒƒ# $
return
…… 
new
…… 

JsonResult
…… !
(
……! "
issue
……" '
)
……' (
;
……( )
}
†† 	
[
 	
HttpGet
	 
(
 
$str
 
)
 
]
  
public
‹‹ 

JsonResult
‹‹ 

GetPmAdmin
‹‹ $
(
‹‹$ %
)
‹‹% &
{
 	
List
 
<
  
PlannedMaintenance
 #
>
# $
pms
% (
=
) *
new
+ .
List
/ 3
<
3 4 
PlannedMaintenance
4 F
>
F G
(
G H
)
H I
;
I J
foreach
 
(
 
var
 
pm
 
in
 
_context
 '
.
' ( 
PlannedMaintenance
( :
)
: ;
{
 
int
‘‘ 
Results
‘‘ 
=
‘‘ 
DateTime
‘‘ &
.
‘‘& '
Compare
‘‘' .
(
‘‘. /
pm
‘‘/ 1
.
‘‘1 2
	scheduled
‘‘2 ;
,
‘‘; <
DateTime
‘‘= E
.
‘‘E F
Now
‘‘F I
)
‘‘I J
;
‘‘J K
if
““ 
(
““ 
Results
““ 
>
““ 
$num
““ 
)
““  
pms
”” 
.
”” 
Add
”” 
(
”” 
pm
”” 
)
”” 
;
””  
}
•• 
var
—— 
	orderByPm
—— 
=
—— 
from
——  
pm
——! #
in
——$ &
pms
——' *
orderby
 #
pm
$ &
.
& '
dateofCreation
' 5
select
™™ "
pm
™™# %
;
™™% &
pms
›› 
=
›› 
	orderByPm
›› 
.
›› 
ToList
›› "
(
››" #
)
››# $
;
››$ %
return
 
new
 

JsonResult
 !
(
! "
pms
" %
)
% &
;
& '
}
 	
[
   	

HttpDelete
  	 
(
   
$str
   $
)
  $ %
]
  % &
public
΅΅ 

JsonResult
΅΅ 
DeletePmAdmin
΅΅ '
(
΅΅' (
int
΅΅( +
id
΅΅, .
)
΅΅. /
{
ΆΆ 	
var
££ 
pm
££ 
=
££ 
_context
££ 
.
££  
PlannedMaintenance
££ 0
.
££0 1
Find
££1 5
(
££5 6
id
££6 8
)
££8 9
;
££9 :
if
¥¥ 
(
¥¥ 
pm
¥¥ 
==
¥¥ 
null
¥¥ 
)
¥¥ 
{
¦¦ 
return
§§ 
new
§§ 

JsonResult
§§ %
(
§§% &
NotFound
§§& .
(
§§. /
)
§§/ 0
)
§§0 1
;
§§1 2
}
¨¨ 
_context
 
.
  
PlannedMaintenance
 '
.
' (
Remove
( .
(
. /
pm
/ 1
)
1 2
;
2 3
_context
¬¬ 
.
¬¬ 
SaveChanges
¬¬  
(
¬¬  !
)
¬¬! "
;
¬¬" #
return
®® 
new
®® 

JsonResult
®® !
(
®®! "
Ok
®®" $
(
®®$ %
pm
®®% '
)
®®' (
)
®®( )
;
®®) *
}
―― 	
[
±± 	
HttpPost
±±	 
(
±± 
$str
±± 
)
±± 
]
±± 
public
²² 

JsonResult
²² 
CreatePm
²² "
(
²²" #
string
²²# )
AffectedSolutions
²²* ;
,
²²; <
string
²²= C
Text
²²D H
,
²²H I
DateTime
²²J R
s
²²S T
)
²²T U
{
³³ 	 
PlannedMaintenance
΄΄ 
pm
΄΄  "
=
΄΄# $
new
΄΄% ( 
PlannedMaintenance
΄΄) ;
(
΄΄; <
AffectedSolutions
΄΄< M
,
΄΄M N
Text
΄΄O S
,
΄΄S T
s
΄΄U V
)
΄΄V W
;
΄΄W X#
CreateEditMaintenance
µµ !
(
µµ! "
pm
µµ" $
)
µµ$ %
;
µµ% &
return
·· 
new
·· 

JsonResult
·· !
(
··! "
pm
··" $
)
··$ %
;
··% &
}
ΈΈ 	
[
ΌΌ 	
HttpGet
ΌΌ	 
(
ΌΌ 
$str
ΌΌ (
)
ΌΌ( )
]
ΌΌ) *
public
½½ 

JsonResult
½½ "
GetHistoricalPmAdmin
½½ .
(
½½. /
)
½½/ 0
{
ΎΎ 	
List
ΏΏ 
<
ΏΏ  
PlannedMaintenance
ΏΏ #
>
ΏΏ# $
pms
ΏΏ% (
=
ΏΏ) *
new
ΏΏ+ .
List
ΏΏ/ 3
<
ΏΏ3 4 
PlannedMaintenance
ΏΏ4 F
>
ΏΏF G
(
ΏΏG H
)
ΏΏH I
;
ΏΏI J
foreach
ΑΑ 
(
ΑΑ 
var
ΑΑ 
pm
ΑΑ 
in
ΑΑ 
_context
ΑΑ '
.
ΑΑ' ( 
PlannedMaintenance
ΑΑ( :
)
ΑΑ: ;
{
ΒΒ 
int
ΓΓ 
Results
ΓΓ 
=
ΓΓ 
DateTime
ΓΓ &
.
ΓΓ& '
Compare
ΓΓ' .
(
ΓΓ. /
pm
ΓΓ/ 1
.
ΓΓ1 2
	scheduled
ΓΓ2 ;
,
ΓΓ; <
DateTime
ΓΓ= E
.
ΓΓE F
Now
ΓΓF I
)
ΓΓI J
;
ΓΓJ K
if
ΕΕ 
(
ΕΕ 
Results
ΕΕ 
<
ΕΕ 
$num
ΕΕ 
)
ΕΕ  
pms
ΖΖ 
.
ΖΖ 
Add
ΖΖ 
(
ΖΖ 
pm
ΖΖ 
)
ΖΖ 
;
ΖΖ  
}
ΗΗ 
var
ΙΙ 
	orderByPm
ΙΙ 
=
ΙΙ 
from
ΙΙ  
pm
ΙΙ! #
in
ΙΙ$ &
pms
ΙΙ' *
orderby
ΚΚ #
pm
ΚΚ$ &
.
ΚΚ& '
dateofCreation
ΚΚ' 5

descending
ΚΚ6 @
select
ΛΛ "
pm
ΛΛ# %
;
ΛΛ% &
pms
ΝΝ 
=
ΝΝ 
	orderByPm
ΝΝ 
.
ΝΝ 
ToList
ΝΝ "
(
ΝΝ" #
)
ΝΝ# $
;
ΝΝ$ %
return
ΟΟ 
new
ΟΟ 

JsonResult
ΟΟ !
(
ΟΟ! "
pms
ΟΟ" %
)
ΟΟ% &
;
ΟΟ& '
}
ΠΠ 	
[
ΣΣ 	
HttpGet
ΣΣ	 
(
ΣΣ 
$str
ΣΣ !
)
ΣΣ! "
]
ΣΣ" #
public
ΤΤ 

JsonResult
ΤΤ 
GetChartIssue
ΤΤ '
(
ΤΤ' (
)
ΤΤ( )
{
ΥΥ 	
int
ΧΧ 
[
ΧΧ 
]
ΧΧ 
tab
ΧΧ 
=
ΧΧ 
{
ΧΧ 
$num
ΧΧ 
,
ΧΧ 
$num
ΧΧ 
,
ΧΧ 
$num
ΧΧ  !
,
ΧΧ! "
$num
ΧΧ# $
}
ΧΧ% &
;
ΧΧ& '
foreach
ΨΨ 
(
ΨΨ 
var
ΨΨ 
issue
ΨΨ 
in
ΨΨ !
_context
ΨΨ" *
.
ΨΨ* +
Issues
ΨΨ+ 1
)
ΨΨ1 2
{
ΩΩ 
if
ΪΪ 
(
ΪΪ 
DateTime
ΪΪ 
.
ΪΪ 
Compare
ΪΪ $
(
ΪΪ$ %
issue
ΪΪ% *
.
ΪΪ* +
ETA
ΪΪ+ .
,
ΪΪ. /
DateTime
ΪΪ0 8
.
ΪΪ8 9
Today
ΪΪ9 >
.
ΪΪ> ?
AddDays
ΪΪ? F
(
ΪΪF G
$num
ΪΪG H
)
ΪΪH I
)
ΪΪI J
<=
ΪΪK M
$num
ΪΪN O
)
ΪΪO P
tab
ΫΫ 
[
ΫΫ 
$num
ΫΫ 
]
ΫΫ 
++
ΫΫ 
;
ΫΫ 
else
άά 
if
άά 
(
άά 
DateTime
άά !
.
άά! "
Compare
άά" )
(
άά) *
issue
άά* /
.
άά/ 0
ETA
άά0 3
,
άά3 4
DateTime
άά5 =
.
άά= >
Today
άά> C
.
άάC D
AddDays
άάD K
(
άάK L
$num
άάL M
)
άάM N
)
άάN O
<=
άάP R
$num
άάS T
)
άάT U
tab
έέ 
[
έέ 
$num
έέ 
]
έέ 
++
έέ 
;
έέ 
else
ήή 
if
ήή 
(
ήή 
DateTime
ήή !
.
ήή! "
Compare
ήή" )
(
ήή) *
issue
ήή* /
.
ήή/ 0
ETA
ήή0 3
,
ήή3 4
DateTime
ήή5 =
.
ήή= >
Today
ήή> C
.
ήήC D
AddDays
ήήD K
(
ήήK L
$num
ήήL N
)
ήήN O
)
ήήO P
<=
ήήQ S
$num
ήήT U
)
ήήU V
tab
ίί 
[
ίί 
$num
ίί 
]
ίί 
++
ίί 
;
ίί 
else
ΰΰ 
if
ΰΰ 
(
ΰΰ 
DateTime
ΰΰ !
.
ΰΰ! "
Compare
ΰΰ" )
(
ΰΰ) *
issue
ΰΰ* /
.
ΰΰ/ 0
ETA
ΰΰ0 3
,
ΰΰ3 4
DateTime
ΰΰ5 =
.
ΰΰ= >
Today
ΰΰ> C
.
ΰΰC D
AddDays
ΰΰD K
(
ΰΰK L
$num
ΰΰL N
)
ΰΰN O
)
ΰΰO P
>
ΰΰQ R
$num
ΰΰS T
)
ΰΰT U
tab
αα 
[
αα 
$num
αα 
]
αα 
++
αα 
;
αα 
}
ββ 
return
δδ 
new
δδ 

JsonResult
δδ !
(
δδ! "
tab
δδ" %
)
δδ% &
;
δδ& '
}
εε 	
[
ηη 	
HttpGet
ηη	 
(
ηη 
$str
ηη 
)
ηη 
]
ηη  
public
θθ 

JsonResult
θθ 

GetChartPm
θθ $
(
θθ$ %
)
θθ% &
{
ιι 	
int
κκ 
[
κκ 
]
κκ 
tab
κκ 
=
κκ 
{
κκ 
$num
κκ 
,
κκ 
$num
κκ 
,
κκ 
$num
κκ  !
,
κκ! "
$num
κκ# $
}
κκ% &
;
κκ& '
foreach
λλ 
(
λλ 
var
λλ 
pm
λλ 
in
λλ 
_context
λλ &
.
λλ& ' 
PlannedMaintenance
λλ' 9
)
λλ9 :
{
μμ 
if
νν 
(
νν 
DateTime
νν 
.
νν 
Compare
νν $
(
νν$ %
pm
νν% '
.
νν' (
	scheduled
νν( 1
,
νν1 2
DateTime
νν3 ;
.
νν; <
Today
νν< A
.
ννA B
AddDays
ννB I
(
ννI J
$num
ννJ K
)
ννK L
)
ννL M
<=
ννN P
$num
ννQ R
)
ννR S
tab
ξξ 
[
ξξ 
$num
ξξ 
]
ξξ 
++
ξξ 
;
ξξ 
else
οο 
if
οο 
(
οο 
DateTime
οο !
.
οο! "
Compare
οο" )
(
οο) *
pm
οο* ,
.
οο, -
	scheduled
οο- 6
,
οο6 7
DateTime
οο8 @
.
οο@ A
Today
οοA F
.
οοF G
AddDays
οοG N
(
οοN O
$num
οοO P
)
οοP Q
)
οοQ R
<=
οοS U
$num
οοV W
)
οοW X
tab
ππ 
[
ππ 
$num
ππ 
]
ππ 
++
ππ 
;
ππ 
else
ρρ 
if
ρρ 
(
ρρ 
DateTime
ρρ !
.
ρρ! "
Compare
ρρ" )
(
ρρ) *
pm
ρρ* ,
.
ρρ, -
	scheduled
ρρ- 6
,
ρρ6 7
DateTime
ρρ8 @
.
ρρ@ A
Today
ρρA F
.
ρρF G
AddDays
ρρG N
(
ρρN O
$num
ρρO Q
)
ρρQ R
)
ρρR S
<=
ρρT V
$num
ρρW X
)
ρρX Y
tab
ςς 
[
ςς 
$num
ςς 
]
ςς 
++
ςς 
;
ςς 
else
σσ 
if
σσ 
(
σσ 
DateTime
σσ !
.
σσ! "
Compare
σσ" )
(
σσ) *
pm
σσ* ,
.
σσ, -
	scheduled
σσ- 6
,
σσ6 7
DateTime
σσ8 @
.
σσ@ A
Today
σσA F
.
σσF G
AddDays
σσG N
(
σσN O
$num
σσO Q
)
σσQ R
)
σσR S
>
σσT U
$num
σσV W
)
σσW X
tab
ττ 
[
ττ 
$num
ττ 
]
ττ 
++
ττ 
;
ττ 
}
υυ 
return
χχ 
new
χχ 

JsonResult
χχ !
(
χχ! "
tab
χχ" %
)
χχ% &
;
χχ& '
}
ψψ 	
}
ύύ 
}ώώ ‹
>C:\Users\lbo\source\repos\LogosAPI\LogosAPI\Data\ApiContext.cs
	namespace 	
LogosAPI
 
. 
Data 
{ 
public 
class 

ApiContext 
:  !
	DbContext" +
{ 	
public		 
DbSet		 
<		 
Issues		 
>		  
Issues		! '
{		( )
get		* -
;		- .
set		/ 2
;		2 3
}		4 5
public

 
DbSet

 
<

 
PlannedMaintenance

 +
>

+ ,
PlannedMaintenance

- ?
{

@ A
get

B E
;

E F
set

G J
;

J K
}

L M
public 
DbSet 
< 
User 
> 
Users $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

ApiContext 
( 
DbContextOptions .
<. /

ApiContext/ 9
>9 :
options; B
)B C
:D E
baseF J
(J K
optionsK R
)R S
{ 
} 
	protected 
override 
void #
OnModelCreating$ 3
(3 4
ModelBuilder4 @
builderA H
)H I
{ 
} 
} 	
} Κ
<C:\Users\lbo\source\repos\LogosAPI\LogosAPI\Models\Issues.cs
	namespace 	
LogosAPI
 
. 
Models 
{ 
public 

class 
Issues 
{ 
public 
int 
id 
{ 
get 
; 
set  
;  !
}" #
public		 
DateTime		 
Date		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public 
string 
AffectedSolutions '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
Text 
{ 
get  
;  !
set" %
;% &
}' (
public 
DateTime 
ETA 
{ 
get !
;! "
set# &
;& '
}( )
public 
DateTime 
? 
Solving  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DateTime 
? 
Closing  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 	
JsonConstructor	 
] 
public 
Issues 
( 
) 
{ 
} 
public 
Issues 
( 
string 
a 
, 
string %
t& '
,' (
DateTime) 1
eta2 5
)5 6
{ 	
this 
. 
id 
= 
$num 
; 
this 
. 
Date 
= 
DateTime  
.  !
Now! $
;$ %
this 
. 
AffectedSolutions "
=# $
a% &
;& '
this 
. 
Text 
= 
t 
; 
this 
. 
ETA 
= 
eta 
; 
this   
.   
Solving   
=   
null   
;    
this!! 
.!! 
Closing!! 
=!! 
null!! 
;!!  
}"" 	
}## 
}$$ ‚
HC:\Users\lbo\source\repos\LogosAPI\LogosAPI\Models\PlannedMaintenance.cs
	namespace 	
LogosAPI
 
. 
Models 
{ 
public 

class 
PlannedMaintenance #
{ 
public 
int 
id 
{ 
get 
; 
set 
;  
}! "
public		 
DateTime		 
dateofCreation		 &
{		' (
get		) ,
;		, -
set		. 1
;		1 2
}		3 4
public 
DateTime 
	scheduled !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
affectedSolutions '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
text 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
JsonConstructor	 
] 
public 
PlannedMaintenance !
(! "
)" #
{$ %
}& '
public 
PlannedMaintenance !
(! "
string" (
a) *
,* +
string, 2
t3 4
,4 5
DateTime6 >
	scheduled? H
)H I
{ 	
this 
. 
id 
= 
$num 
; 
this 
. 
dateofCreation 
=  !
DateTime" *
.* +
Now+ .
;. /
this 
. 
affectedSolutions "
=# $
a% &
;& '
this 
. 
text 
= 
t 
; 
this 
. 
	scheduled 
= 
	scheduled &
;& '
} 	
} 
} φ
:C:\Users\lbo\source\repos\LogosAPI\LogosAPI\Models\User.cs
	namespace 	
LogosAPI
 
. 
Models 
{ 
public 

class 
User 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
UserName 
{  
get! $
;$ %
set& )
;) *
}+ ,
=/ 0
string1 7
.7 8
Empty8 =
;= >
public		 
byte		 
[		 
]		 
PasswordHash		 "
{		# $
get		% (
;		( )
set		* -
;		- .
}		/ 0
public

 
byte

 
[

 
]

 
PasswordSalt

 "
{

# $
get

% (
;

( )
set

* -
;

- .
}

/ 0
} 
} α
=C:\Users\lbo\source\repos\LogosAPI\LogosAPI\Models\UserDto.cs
	namespace 	
LogosAPI
 
. 
Models 
{ 
public 

class 
UserDto 
{ 
public 
string 
UserName 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
} 
} • 
6C:\Users\lbo\source\repos\LogosAPI\LogosAPI\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. 
AddDbContext 
< 

ApiContext (
>( )
() *
opt* -
=>. 0
opt1 4
.4 5
UseInMemoryDatabase5 H
(H I
$strI [
)[ \
)\ ]
;] ^
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
builder 
. 
Services 
. 
AddAuthentication "
(" #
JwtBearerDefaults# 4
.4 5 
AuthenticationScheme5 I
)I J
. 
AddJwtBearer 
( 
options 
=> 
{ 
options 
. %
TokenValidationParameters )
=* +
new, /%
TokenValidationParameters0 I
{ 	$
ValidateIssuerSigningKey $
=% &
true' +
,+ ,
IssuerSigningKey 
= 
new " 
SymmetricSecurityKey# 7
(7 8
Encoding8 @
.@ A
UTF8A E
.E F
GetBytesF N
(N O
builderO V
.V W
ConfigurationW d
.d e

GetSectione o
(o p
$str	p ƒ
)
ƒ „
.
„ …
Value
… 
)
 ‹
)
‹ 
,
 
ValidateIssuer 
= 
false "
," #
ValidateAudience 
= 
false $
,$ %
} 	
;	 

} 
) 
; 
var 
cors 
=	 

$str 
; 
builder 
. 
Services 
. 
AddCors 
( 
opt 
=> 
{ 
opt   
.   
	AddPolicy   
(   
cors   
,   
builder   
=>    "
{!! 
builder"" 
."" 
AllowAnyMethod"" 
("" 
)""  
.""  !
AllowAnyHeader""! /
(""/ 0
)""0 1
;""1 2
}## 
)## 
;## 
}$$ 
)$$ 
;$$ 
var&& 
app&& 
=&& 	
builder&&
 
.&& 
Build&& 
(&& 
)&& 
;&& 
if)) 
()) 
app)) 
.)) 
Environment)) 
.)) 
IsDevelopment)) !
())! "
)))" #
)))# $
{** 
app++ 
.++ 

UseSwagger++ 
(++ 
)++ 
;++ 
app,, 
.,, 
UseSwaggerUI,, 
(,, 
),, 
;,, 
}-- 
app// 
.// 
UseHttpsRedirection// 
(// 
)// 
;// 
app11 
.11 
UseCors11 
(11 
cors11 
)11 
;11 
app33 
.33 
UseAuthentication33 
(33 
)33 
;33 
app55 
.55 
UseAuthorization55 
(55 
)55 
;55 
app77 
.77 
MapControllers77 
(77 
)77 
;77 
app99 
.99 
Run99 
(99 
)99 	
;99	 
